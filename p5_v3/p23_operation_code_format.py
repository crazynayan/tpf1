from p5_v3.p01_errors import ParserError
from p5_v3.p22_format import TermFormat, GenericFormat, EquFormat, ExpressionFormat, NoOperandFormat, MacroCallFormat, RRFormat, SS1Format, \
    SS2Format, SS3Format, RSLFormat, SIFormat, SFormat, SILFormat, RXYFormat, RXFormat, RIL1Format, RS1Format, RI1Format, RS2Format, \
    RSIFormat, RI2Format, RXMnemonicFormat, RI2MnemonicFormat


class OperationCodeFormat:
    # Assembler Directive
    DS = TermFormat
    DC = TermFormat
    EQU = EquFormat
    ORG = ExpressionFormat
    DSECT = NoOperandFormat
    CSECT = NoOperandFormat
    USING = ExpressionFormat
    DROP = ExpressionFormat
    PUSH = ExpressionFormat
    POP = ExpressionFormat
    SPACE = ExpressionFormat
    EJECT = NoOperandFormat
    PRINT = MacroCallFormat
    BEGIN = MacroCallFormat
    LTORG = NoOperandFormat
    FINIS = NoOperandFormat
    END = NoOperandFormat
    MACRO = NoOperandFormat
    AIF = NoOperandFormat
    AGO = NoOperandFormat
    ANOP = NoOperandFormat
    ACTR = NoOperandFormat
    SETA = NoOperandFormat
    SETB = NoOperandFormat
    SETC = NoOperandFormat
    GBLA = NoOperandFormat
    GBLB = NoOperandFormat
    GBLC = NoOperandFormat
    LCLA = NoOperandFormat
    LCLB = NoOperandFormat
    # Machine Instruction
    BCTR = RRFormat
    BR = RRFormat
    LR = RRFormat
    LTR = RRFormat
    AR = RRFormat
    SR = RRFormat
    BER = RRFormat
    BNER = RRFormat
    BHR = RRFormat
    BNHR = RRFormat
    BLR = RRFormat
    BNLR = RRFormat
    BMR = RRFormat
    BPR = RRFormat
    BNPR = RRFormat
    BCR = RRFormat
    BOR = RRFormat
    BNOR = RRFormat
    BZR = RRFormat
    BNZR = RRFormat
    NOPR = RRFormat
    LPR = RRFormat
    LNR = RRFormat
    LCR = RRFormat
    MR = RRFormat
    DR = RRFormat
    MVCL = RRFormat
    BASR = RRFormat
    CR = RRFormat
    CLR = RRFormat
    CLCL = RRFormat
    ALR = RRFormat
    SLR = RRFormat
    NR = RRFormat
    OR = RRFormat
    XR = RRFormat
    OC = SS1Format
    XC = SS1Format
    NC = SS1Format
    CLC = SS1Format
    UNPK = SS2Format
    PACK = SS2Format
    MVC = SS1Format
    MVZ = SS1Format
    MVN = SS1Format
    MVO = SS2Format
    ZAP = SS2Format
    AP = SS2Format
    SP = SS2Format
    MP = SS2Format
    CP = SS2Format
    TP = RSLFormat
    SRP = SS3Format
    TR = SS1Format
    TRT = SS1Format
    ED = SS1Format
    EDMK = SS1Format
    OI = SIFormat
    NI = SIFormat
    XI = SIFormat
    TM = SIFormat
    STCK = SFormat
    CLI = SIFormat
    CLHHSI = SILFormat
    MVI = SIFormat
    MVHHI = SILFormat
    LG = RXYFormat
    L = RXFormat
    LH = RXFormat
    LA = RXFormat
    LARL = RIL1Format
    IC = RXFormat
    LLC = RXYFormat
    STH = RXFormat
    N = RXFormat
    O = RXFormat
    X = RXFormat
    ST = RXFormat
    STG = RXFormat
    STC = RXFormat
    CVB = RXFormat
    CVD = RXFormat
    CH = RXFormat
    C = RXFormat
    CL = RXFormat
    A = RXFormat
    AH = RXFormat
    AL = RXFormat
    S = RXFormat
    SH = RXFormat
    SL = RXFormat
    MH = RXFormat
    M = RXFormat
    D = RXFormat
    SLA = RS1Format
    SRA = RS1Format
    SLDA = RS1Format
    SRDA = RS1Format
    SLL = RS1Format
    SRL = RS1Format
    SLDL = RS1Format
    SRDL = RS1Format
    AFI = RIL1Format
    AHI = RI1Format
    LHI = RI1Format
    CHI = RI1Format
    MHI = RI1Format
    LM = RS1Format
    STM = RS1Format
    ICM = RS2Format
    STCM = RS2Format
    CLM = RS2Format
    BAL = RXFormat
    BAS = RXFormat
    JAS = RI1Format
    BRAS = RI1Format
    BCT = RXFormat
    JCT = RI1Format
    BRCT = RI1Format
    BXH = RS1Format
    JXH = RSIFormat
    BRXH = RSIFormat
    BXLE = RS1Format
    JXLE = RSIFormat
    BRXLE = RSIFormat
    EX = RXFormat
    BC = RXFormat
    JC = RI2Format
    BRC = RI2Format
    B = RXMnemonicFormat
    J = RI2MnemonicFormat
    BRU = RI2MnemonicFormat
    NOP = RXMnemonicFormat
    JNOP = RI2MnemonicFormat
    BH = RXMnemonicFormat
    JH = RI2MnemonicFormat
    BRH = RI2MnemonicFormat
    BL = RXMnemonicFormat
    JL = RI2MnemonicFormat
    BRL = RI2MnemonicFormat
    BE = RXMnemonicFormat
    JE = RI2MnemonicFormat
    BRE = RI2MnemonicFormat
    BNH = RXMnemonicFormat
    JNH = RI2MnemonicFormat
    BRNH = RI2MnemonicFormat
    BNL = RXMnemonicFormat
    JNL = RI2MnemonicFormat
    BRNL = RI2MnemonicFormat
    BNE = RXMnemonicFormat
    JNE = RI2MnemonicFormat
    BRNE = RI2MnemonicFormat
    BP = RXMnemonicFormat
    JP = RI2MnemonicFormat
    BRP = RI2MnemonicFormat
    BM = RXMnemonicFormat
    JM = RI2MnemonicFormat
    BRM = RI2MnemonicFormat
    BZ = RXMnemonicFormat
    JZ = RI2MnemonicFormat
    BRZ = RI2MnemonicFormat
    BO = RXMnemonicFormat
    JO = RI2MnemonicFormat
    BRO = RI2MnemonicFormat
    BNP = RXMnemonicFormat
    JNP = RI2MnemonicFormat
    BRNP = RI2MnemonicFormat
    BNM = RXMnemonicFormat
    JNM = RI2MnemonicFormat
    BRNM = RI2MnemonicFormat
    BNZ = RXMnemonicFormat
    JNZ = RI2MnemonicFormat
    BRNZ = RI2MnemonicFormat
    BNO = RXMnemonicFormat
    JNO = RI2MnemonicFormat
    BRNO = RI2MnemonicFormat
    # Realtime macros
    GETCC = "GETCC"
    LEVTA = "LEVTA"
    MODEC = "MODEC"
    DETAC = "DETAC"
    ATTAC = "ATTAC"
    RELCC = "RELCC"
    RCUNC = "RCUNC"
    RELFC = "RELFC"
    RLCHA = "RLCHA"
    CRUSA = "CRUSA"
    SENDA = "SENDA"
    SYSRA = "SYSRA"
    SERRC = "SERRC"
    SNAPC = "SNAPC"
    ENTRC = "ENTRC"
    ENTNC = "ENTNC"
    ENTDC = "ENTDC"
    BACKC = "BACKC"
    ALASC = "ALASC"
    PNAMC = "PNAMC"
    FLIPC = "FLIPC"
    EOWNRC = "EOWNRC"
    CREMC = "CREMC"
    CREDC = "CREDC"
    CREEC = "CREEC"
    SWISC = "SWISC"
    POSTC = "POSTC"
    EVNTC = "EVNTC"
    EVNQC = "EVNQC"
    EVNWC = "EVNWC"
    GLMOD = "GLMOD"
    FILKW = "FILKW"
    KEYCC = "KEYCC"
    KEYRC = "KEYRC"
    GLBLC = "GLBLC"
    DLAYC = "DLAYC"
    DEFRC = "DEFRC"
    REALTIMA = "REALTIMA"
    MALOC = "MALOC"
    CALOC = "CALOC"
    FREEC = "FREEC"
    CINFC = "CINFC"
    WTOPC = "WTOPC"
    FINWC = "FINWC"
    FIWHC = "FIWHC"
    FINHC = "FINHC"
    SONIC = "SONIC"
    GETFC = "GETFC"
    FILUC = "FILUC"
    FILEC = "FILEC"
    FILNC = "FILNC"
    WAITC = "WAITC"
    UNFRC = "UNFRC"
    DBOPN = "DBOPN"
    DBRED = "DBRED"
    DBCLS = "DBCLS"
    DBIFB = "DBIFB"
    DBADD = "DBADD"
    DBDEL = "DBDEL"
    DBMOD = "DBMOD"
    DBREP = "DBREP"
    EXITC = "EXITC"


def get_base_operation_format(operation_code: str) -> GenericFormat:
    try:
        return getattr(OperationCodeFormat, operation_code)
    except AttributeError:
        raise ParserError


def get_operation_format(operation_code: str) -> GenericFormat:
    return get_base_operation_format(operation_code)
